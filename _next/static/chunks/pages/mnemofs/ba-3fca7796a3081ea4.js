(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[210],{5671:function(e,n,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mnemofs/ba",function(){return o(7682)}])},7682:function(e,n,o){"use strict";o.r(n),o.d(n,{__toc:function(){return h},home:function(){return c},next:function(){return m},prev:function(){return l}});var t=o(2676),a=o(109),s=o(9394),i=o(5904);o(1705);var r=o(9100),d=o(353);let l="/mnemofs/mn",c="/",m="/mnemofs/mideval",h=[{depth:2,value:"Conclusion",id:"conclusion"}];function u(e){let n=Object.assign({h1:"h1",p:"p",strong:"strong",h2:"h2",hr:"hr"},(0,r.a)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{textAlign:"justify"},children:[(0,t.jsx)(n.h1,{children:"Mnemofs's Block Allocator"}),(0,t.jsx)(n.p,{children:"The block allocator of mnemofs is inspired by littlefs a lot, but it differs a lot. Since NAND flashes are a common device used for sensors, the allocation of blocks or pages needs to be fast. This means shifting the RAM vs. speed tradeoff a little bit so that it consumes more RAM."}),(0,t.jsxs)(n.p,{children:["The block allocator wants to be fair and spread wear as evenly as possible. So, like littlefs's block allocator, this starts with a random block and keeps assigning pages. Now, in mnemofs, pages and blocks can both be expected from the block allocator. In this case, the block allocator skips pages until the start of the next nearest block, and allocates from there. Since most block allocations are done by internal data structures, and they happen in bulk, skipped pages are not too much in count. Contiguous allocation ",(0,t.jsx)(n.strong,{children:"may"})," happen, but it may not as well."]}),(0,t.jsx)(n.p,{children:"The block allocator contains a bitmap of each page to denote if it's being used or not. The block allocator also contains an array of counters for each block in the device. These counters count the number of pages inside that block that want to be deleted. If all of the pages inside a block want to be erased, then the next time the block allocator comes across this block (or any page in it), it will immediately erase the block and then allocate blocks or pages."}),(0,t.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),(0,t.jsx)(n.p,{children:"So, all in all, these are the ins and outs of mnemofs. Is it a weird place to end the series? There are follow-up blogs of my journey in designing and implementing this file system!"})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(d.oy,{children:[(0,t.jsx)(d.Zb,{icon:"❰ ",title:"Mnemofs Master Node",href:l}),(0,t.jsx)(d.Zb,{icon:"❱ ",title:"GSoC '24 @ Apache NuttX, Mid Term Evaluation Blog",href:m})]}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(d.Zb,{icon:"⌂ ",title:"Home",href:c})]})}let f={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.a)(),e.components);return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)},pageOpts:{filePath:"pages/mnemofs/ba.mdx",route:"/mnemofs/ba",timestamp:1741549137e3,pageMap:[{kind:"MdxPage",name:"coming_soon",route:"/coming_soon"},{kind:"Folder",name:"embedded",route:"/embedded",children:[{kind:"MdxPage",name:"blinky_scratch",route:"/embedded/blinky_scratch"},{kind:"MdxPage",name:"embedded",route:"/embedded/embedded"},{kind:"Meta",data:{blinky_scratch:"Blinky Scratch",embedded:"Embedded"}}]},{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"mnemofs",route:"/mnemofs",children:[{kind:"MdxPage",name:"ba",route:"/mnemofs/ba"},{kind:"MdxPage",name:"endeval",route:"/mnemofs/endeval"},{kind:"MdxPage",name:"intro_p1",route:"/mnemofs/intro_p1"},{kind:"MdxPage",name:"intro_p2",route:"/mnemofs/intro_p2"},{kind:"MdxPage",name:"intro_p3",route:"/mnemofs/intro_p3"},{kind:"MdxPage",name:"journal",route:"/mnemofs/journal"},{kind:"MdxPage",name:"lru",route:"/mnemofs/lru"},{kind:"MdxPage",name:"mideval",route:"/mnemofs/mideval"},{kind:"MdxPage",name:"mn",route:"/mnemofs/mn"},{kind:"MdxPage",name:"mnemofs",route:"/mnemofs/mnemofs"},{kind:"Meta",data:{ba:"Ba",endeval:"Endeval",intro_p1:"Intro P1",intro_p2:"Intro P2",intro_p3:"Intro P3",journal:"Journal",lru:"Lru",mideval:"Mideval",mn:"Mn",mnemofs:"Mnemofs"}}]},{kind:"Folder",name:"os",route:"/os",children:[{kind:"MdxPage",name:"bare_bones",route:"/os/bare_bones"},{kind:"MdxPage",name:"boot",route:"/os/boot"},{kind:"MdxPage",name:"interactive_riscv",route:"/os/interactive_riscv"},{kind:"MdxPage",name:"motherboard",route:"/os/motherboard"},{kind:"MdxPage",name:"os",route:"/os/os"},{kind:"Meta",data:{bare_bones:"Bare Bones",boot:"Boot",interactive_riscv:"Interactive Riscv",motherboard:"Motherboard",os:"Os"}}]},{kind:"Meta",data:{coming_soon:"Coming Soon",index:"Index"}}],flexsearch:{codeblocks:!0},title:"Mnemofs's Block Allocator",headings:h},pageNextRoute:"/mnemofs/ba",nextraLayout:s.ZP,themeConfig:i.Z};n.default=(0,a.j)(f)},5904:function(e,n,o){"use strict";var t=o(2676);n.Z={footer:(0,t.jsx)("p",{children:"MIT 2024 \xa9 resyfer."}),head:e=>{let{title:n,meta:o}=e;return(0,t.jsxs)(t.Fragment,{children:[o.description&&(0,t.jsx)("meta",{name:"description",content:o.description}),o.tag&&(0,t.jsx)("meta",{name:"keywords",content:o.tag}),o.author&&(0,t.jsx)("meta",{name:"author",content:o.author}),(0,t.jsx)("script",{async:!0,src:"https://www.googletagmanager.com/gtag/js?id=G-HFNGDFK1PN"}),(0,t.jsx)("script",{children:"\n        window.dataLayer = window.dataLayer || [];\n        function gtag(){dataLayer.push(arguments);}\n        gtag('js', new Date());\n\n        gtag('config', 'G-HFNGDFK1PN');\n        "})]})},postFooter:!1}}},function(e){e.O(0,[253,888,774,179],function(){return e(e.s=5671)}),_N_E=e.O()}]);